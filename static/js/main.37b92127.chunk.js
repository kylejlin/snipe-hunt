(this["webpackJsonpsnipe-hunt"]=this["webpackJsonpsnipe-hunt"]||[]).push([[0],[,,,,,,,,,,,,function(e,t,n){},,,,function(e,t,n){e.exports=function(){return new Worker(n.p+"288d488608b0ccd2c35d.worker.js")}},,,function(e,t,n){e.exports=n(31)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"getRandomGameState",(function(){return U})),n.d(a,"isReserve",(function(){return H})),n.d(a,"canRetreat",(function(){return J})),n.d(a,"opponentOf",(function(){return Y})),n.d(a,"snipeOf",(function(){return $})),n.d(a,"oneRowForward",(function(){return K})),n.d(a,"oneRowBackward",(function(){return Z})),n.d(a,"isRow",(function(){return Q})),n.d(a,"decodePly",(function(){return X})),n.d(a,"isAnimalStep",(function(){return ee}));var r={};n.r(r),n.d(r,"getStateAnalyzer",(function(){return ne}));var i={};n.r(i),n.d(i,"NODE_SIZE_IN_I32S",(function(){return ie})),n.d(i,"getMctsAnalyzerIfStateIsNonTerminal",(function(){return le})),n.d(i,"getMctsAnalyzerFromInternalDataWithoutInitializing",(function(){return se})),n.d(i,"pointerToIndex",(function(){return ue})),n.d(i,"indexToPointer",(function(){return ce}));var o,l,s,u=n(0),c=n.n(u),p=n(13),m=n.n(p),d=(n(24),n(2)),h=n(4),f=n(14),S=n(15),v=n(5),A=n(18),g=n(17),y=n(1);n(25);!function(e){e.None="None",e.BestAction="BestAction",e.AllActions="AllActions"}(l||(l={})),function(e){e[e.AlphaReserve=0]="AlphaReserve",e[e.Row1=1]="Row1",e[e.Row2=2]="Row2",e[e.Row3=3]="Row3",e[e.Row4=4]="Row4",e[e.Row5=5]="Row5",e[e.Row6=6]="Row6",e[e.BetaReserve=7]="BetaReserve"}(s||(s={}));var b,C=[s.AlphaReserve,s.Row1,s.Row2,s.Row3,s.Row4,s.Row5,s.Row6,s.BetaReserve],E=[s.Row1,s.Row2,s.Row3,s.Row4,s.Row5,s.Row6];!function(e){e[e.Mouse1=0]="Mouse1",e[e.Ox1=1]="Ox1",e[e.Tiger1=2]="Tiger1",e[e.Rabbit1=3]="Rabbit1",e[e.Dragon1=4]="Dragon1",e[e.Snake1=5]="Snake1",e[e.Horse1=6]="Horse1",e[e.Ram1=7]="Ram1",e[e.Monkey1=8]="Monkey1",e[e.Rooster1=9]="Rooster1",e[e.Dog1=10]="Dog1",e[e.Boar1=11]="Boar1",e[e.Fish1=12]="Fish1",e[e.Elephant1=13]="Elephant1",e[e.Squid1=14]="Squid1",e[e.Frog1=15]="Frog1",e[e.Mouse2=16]="Mouse2",e[e.Ox2=17]="Ox2",e[e.Tiger2=18]="Tiger2",e[e.Rabbit2=19]="Rabbit2",e[e.Dragon2=20]="Dragon2",e[e.Snake2=21]="Snake2",e[e.Horse2=22]="Horse2",e[e.Ram2=23]="Ram2",e[e.Monkey2=24]="Monkey2",e[e.Rooster2=25]="Rooster2",e[e.Dog2=26]="Dog2",e[e.Boar2=27]="Boar2",e[e.Fish2=28]="Fish2",e[e.Elephant2=29]="Elephant2",e[e.Squid2=30]="Squid2",e[e.Frog2=31]="Frog2",e[e.AlphaSnipe=32]="AlphaSnipe",e[e.BetaSnipe=33]="BetaSnipe"}(b||(b={}));var R,T=[b.Mouse1,b.Ox1,b.Tiger1,b.Rabbit1,b.Dragon1,b.Snake1,b.Horse1,b.Ram1,b.Monkey1,b.Rooster1,b.Dog1,b.Boar1,b.Fish1,b.Elephant1,b.Squid1,b.Frog1,b.Mouse2,b.Ox2,b.Tiger2,b.Rabbit2,b.Dragon2,b.Snake2,b.Horse2,b.Ram2,b.Monkey2,b.Rooster2,b.Dog2,b.Boar2,b.Fish2,b.Elephant2,b.Squid2,b.Frog2];!function(e){e[e.Alpha=0]="Alpha",e[e.Beta=1]="Beta"}(R||(R={}));var B,k,w,N,O,P,L,M,F=(o={},Object(d.a)(o,R.Alpha,[s.Row1,s.Row2,s.Row3,s.Row4]),Object(d.a)(o,R.Beta,[s.Row3,s.Row4,s.Row5,s.Row6]),o);!function(e){e[e.SnipeStep=0]="SnipeStep",e[e.Drop=1]="Drop",e[e.TwoAnimalSteps=2]="TwoAnimalSteps"}(B||(B={})),function(e){e[e.SnipeAlreadyCaptured=0]="SnipeAlreadyCaptured",e[e.AlreadyMovedAnimal=1]="AlreadyMovedAnimal",e[e.StepDestinationOutOfRange=2]="StepDestinationOutOfRange",e[e.CannotEmptyRowWithoutImmediatelyWinning=3]="CannotEmptyRowWithoutImmediatelyWinning",e[e.DroppedAnimalNotInReserve=4]="DroppedAnimalNotInReserve",e[e.CannotEmptyReserve=5]="CannotEmptyReserve",e[e.CannotDropRetreaterOnEnemysBackTwoRows=6]="CannotDropRetreaterOnEnemysBackTwoRows",e[e.MovedCardInReserve=7]="MovedCardInReserve",e[e.NotYourAnimal=8]="NotYourAnimal",e[e.CannotMoveSameAnimalTwice=9]="CannotMoveSameAnimalTwice",e[e.CannotCaptureOwnSnipeWithoutAlsoCapturingOpponents=10]="CannotCaptureOwnSnipeWithoutAlsoCapturingOpponents",e[e.NothingToUndo=11]="NothingToUndo"}(k||(k={})),function(e){e[e.Fire=0]="Fire",e[e.Water=1]="Water",e[e.Earth=2]="Earth",e[e.Air=3]="Air"}(w||(w={})),function(e){e[e.F1=1]="F1",e[e.F2=2]="F2",e[e.F3=4]="F3",e[e.W1=8]="W1",e[e.W2=16]="W2",e[e.W3=32]="W3",e[e.E1=64]="E1",e[e.E2=128]="E2",e[e.E3=256]="E3",e[e.A1=512]="A1",e[e.A2=1024]="A2",e[e.A3=2048]="A3"}(N||(N={})),function(e){e[e.Fire=0]="Fire",e[e.Water=3]="Water",e[e.Earth=6]="Earth",e[e.Air=9]="Air",e[e.None=12]="None"}(O||(O={})),function(e){e[e.UpdateGameStateRequest=0]="UpdateGameStateRequest",e[e.PauseAnalyzerRequest=1]="PauseAnalyzerRequest",e[e.ResumeAnalyzerRequest=2]="ResumeAnalyzerRequest",e[e.LogNotification=3]="LogNotification",e[e.UpdateSnapshotNotification=4]="UpdateSnapshotNotification",e[e.PauseAnalyzerResponse=5]="PauseAnalyzerResponse",e[e.StopTimeChangeNotification=6]="StopTimeChangeNotification"}(P||(P={}));var j,I,x,D=(L={},Object(d.a)(L,b.Mouse1,{elements:y.option.some({double:w.Fire,single:w.Earth}),elementCounts:N.F2|N.E1,tripletShifts:[O.Fire,O.Earth],canRetreat:!0}),Object(d.a)(L,b.Ox1,{elements:y.option.some({double:w.Earth,single:w.Water}),elementCounts:N.E2|N.W1,tripletShifts:[O.Earth,O.Water],canRetreat:!1}),Object(d.a)(L,b.Tiger1,{elements:y.option.some({double:w.Fire,single:w.Fire}),elementCounts:N.F3,tripletShifts:[O.Fire,O.None],canRetreat:!1}),Object(d.a)(L,b.Rabbit1,{elements:y.option.some({double:w.Air,single:w.Water}),elementCounts:N.A2|N.W1,tripletShifts:[O.Air,O.Water],canRetreat:!0}),Object(d.a)(L,b.Dragon1,{elements:y.option.some({double:w.Air,single:w.Air}),elementCounts:N.A3,tripletShifts:[O.Air,O.None],canRetreat:!1}),Object(d.a)(L,b.Snake1,{elements:y.option.some({double:w.Water,single:w.Earth}),elementCounts:N.W2|N.E1,tripletShifts:[O.Water,O.Earth],canRetreat:!0}),Object(d.a)(L,b.Horse1,{elements:y.option.some({double:w.Fire,single:w.Air}),elementCounts:N.F2|N.A1,tripletShifts:[O.Fire,O.Air],canRetreat:!1}),Object(d.a)(L,b.Ram1,{elements:y.option.some({double:w.Earth,single:w.Air}),elementCounts:N.E2|N.A1,tripletShifts:[O.Earth,O.Air],canRetreat:!0}),Object(d.a)(L,b.Monkey1,{elements:y.option.some({double:w.Air,single:w.Earth}),elementCounts:N.A2|N.E1,tripletShifts:[O.Air,O.Earth],canRetreat:!1}),Object(d.a)(L,b.Rooster1,{elements:y.option.some({double:w.Air,single:w.Fire}),elementCounts:N.A2|N.F1,tripletShifts:[O.Air,O.Fire],canRetreat:!1}),Object(d.a)(L,b.Dog1,{elements:y.option.some({double:w.Fire,single:w.Water}),elementCounts:N.F2|N.W1,tripletShifts:[O.Fire,O.Water],canRetreat:!1}),Object(d.a)(L,b.Boar1,{elements:y.option.some({double:w.Earth,single:w.Fire}),elementCounts:N.E2|N.F1,tripletShifts:[O.Earth,O.Fire],canRetreat:!0}),Object(d.a)(L,b.Fish1,{elements:y.option.some({double:w.Water,single:w.Water}),elementCounts:N.W3,tripletShifts:[O.Water,O.None],canRetreat:!1}),Object(d.a)(L,b.Elephant1,{elements:y.option.some({double:w.Earth,single:w.Earth}),elementCounts:N.E3,tripletShifts:[O.Earth,O.None],canRetreat:!1}),Object(d.a)(L,b.Squid1,{elements:y.option.some({double:w.Water,single:w.Fire}),elementCounts:N.W2|N.F1,tripletShifts:[O.Water,O.Fire],canRetreat:!0}),Object(d.a)(L,b.Frog1,{elements:y.option.some({double:w.Water,single:w.Air}),elementCounts:N.W2|N.A1,tripletShifts:[O.Water,O.Air],canRetreat:!1}),Object(d.a)(L,b.Mouse2,{elements:y.option.some({double:w.Fire,single:w.Earth}),elementCounts:N.F2|N.E1,tripletShifts:[O.Fire,O.Earth],canRetreat:!0}),Object(d.a)(L,b.Ox2,{elements:y.option.some({double:w.Earth,single:w.Water}),elementCounts:N.E2|N.W1,tripletShifts:[O.Earth,O.Water],canRetreat:!1}),Object(d.a)(L,b.Tiger2,{elements:y.option.some({double:w.Fire,single:w.Fire}),elementCounts:N.F3,tripletShifts:[O.Fire,O.None],canRetreat:!1}),Object(d.a)(L,b.Rabbit2,{elements:y.option.some({double:w.Air,single:w.Water}),elementCounts:N.A2|N.W1,tripletShifts:[O.Air,O.Water],canRetreat:!0}),Object(d.a)(L,b.Dragon2,{elements:y.option.some({double:w.Air,single:w.Air}),elementCounts:N.A3,tripletShifts:[O.Air,O.None],canRetreat:!1}),Object(d.a)(L,b.Snake2,{elements:y.option.some({double:w.Water,single:w.Earth}),elementCounts:N.W2|N.E1,tripletShifts:[O.Water,O.Earth],canRetreat:!0}),Object(d.a)(L,b.Horse2,{elements:y.option.some({double:w.Fire,single:w.Air}),elementCounts:N.F2|N.A1,tripletShifts:[O.Fire,O.Air],canRetreat:!1}),Object(d.a)(L,b.Ram2,{elements:y.option.some({double:w.Earth,single:w.Air}),elementCounts:N.E2|N.A1,tripletShifts:[O.Earth,O.Air],canRetreat:!0}),Object(d.a)(L,b.Monkey2,{elements:y.option.some({double:w.Air,single:w.Earth}),elementCounts:N.A2|N.E1,tripletShifts:[O.Air,O.Earth],canRetreat:!1}),Object(d.a)(L,b.Rooster2,{elements:y.option.some({double:w.Air,single:w.Fire}),elementCounts:N.A2|N.F1,tripletShifts:[O.Air,O.Fire],canRetreat:!1}),Object(d.a)(L,b.Dog2,{elements:y.option.some({double:w.Fire,single:w.Water}),elementCounts:N.F2|N.W1,tripletShifts:[O.Fire,O.Water],canRetreat:!1}),Object(d.a)(L,b.Boar2,{elements:y.option.some({double:w.Earth,single:w.Fire}),elementCounts:N.E2|N.F1,tripletShifts:[O.Earth,O.Fire],canRetreat:!0}),Object(d.a)(L,b.Fish2,{elements:y.option.some({double:w.Water,single:w.Water}),elementCounts:N.W3,tripletShifts:[O.Water,O.None],canRetreat:!1}),Object(d.a)(L,b.Elephant2,{elements:y.option.some({double:w.Earth,single:w.Earth}),elementCounts:N.E3,tripletShifts:[O.Earth,O.None],canRetreat:!1}),Object(d.a)(L,b.Squid2,{elements:y.option.some({double:w.Water,single:w.Fire}),elementCounts:N.W2|N.F1,tripletShifts:[O.Water,O.Fire],canRetreat:!0}),Object(d.a)(L,b.Frog2,{elements:y.option.some({double:w.Water,single:w.Air}),elementCounts:N.W2|N.A1,tripletShifts:[O.Water,O.Air],canRetreat:!1}),Object(d.a)(L,b.AlphaSnipe,{elements:y.option.none(),elementCounts:0,tripletShifts:[O.None,O.None],canRetreat:!0}),Object(d.a)(L,b.BetaSnipe,{elements:y.option.none(),elementCounts:0,tripletShifts:[O.None,O.None],canRetreat:!0}),L),W=(M={},Object(d.a)(M,b.Mouse1,"\ud83d\udc00"),Object(d.a)(M,b.Mouse2,"\ud83d\udc00"),Object(d.a)(M,b.Ox1,"\ud83d\udc2e"),Object(d.a)(M,b.Ox2,"\ud83d\udc2e"),Object(d.a)(M,b.Tiger1,"\ud83d\udc2f"),Object(d.a)(M,b.Tiger2,"\ud83d\udc2f"),Object(d.a)(M,b.Rabbit1,"\ud83d\udc07"),Object(d.a)(M,b.Rabbit2,"\ud83d\udc07"),Object(d.a)(M,b.Dragon1,"\ud83d\udc09 "),Object(d.a)(M,b.Dragon2,"\ud83d\udc09 "),Object(d.a)(M,b.Snake1,"\ud83d\udc0d"),Object(d.a)(M,b.Snake2,"\ud83d\udc0d"),Object(d.a)(M,b.Horse1,"\ud83d\udc34"),Object(d.a)(M,b.Horse2,"\ud83d\udc34"),Object(d.a)(M,b.Ram1,"\ud83d\udc0f"),Object(d.a)(M,b.Ram2,"\ud83d\udc0f"),Object(d.a)(M,b.Monkey1,"\ud83d\udc35"),Object(d.a)(M,b.Monkey2,"\ud83d\udc35"),Object(d.a)(M,b.Rooster1,"\ud83d\udc13"),Object(d.a)(M,b.Rooster2,"\ud83d\udc13"),Object(d.a)(M,b.Dog1,"\ud83d\udc36"),Object(d.a)(M,b.Dog2,"\ud83d\udc36"),Object(d.a)(M,b.Boar1,"\ud83d\udc17"),Object(d.a)(M,b.Boar2,"\ud83d\udc17"),Object(d.a)(M,b.Fish1,"\ud83d\udc1f"),Object(d.a)(M,b.Fish2,"\ud83d\udc1f"),Object(d.a)(M,b.Elephant1,"\ud83d\udc18"),Object(d.a)(M,b.Elephant2,"\ud83d\udc18"),Object(d.a)(M,b.Squid1,"\ud83e\udd91"),Object(d.a)(M,b.Squid2,"\ud83e\udd91"),Object(d.a)(M,b.Frog1,"\ud83d\udc38"),Object(d.a)(M,b.Frog2,"\ud83d\udc38"),Object(d.a)(M,b.AlphaSnipe,"\u03b1"),Object(d.a)(M,b.BetaSnipe,"\u03b2"),M);function q(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>24}!function(e){e[e.AlphaAnimals=0]="AlphaAnimals",e[e.BetaAnimals=1]="BetaAnimals",e[e.Snipes=2]="Snipes"}(j||(j={})),function(e){e[e.LeastBit=1]="LeastBit",e[e.LeastTwoBits=3]="LeastTwoBits",e[e.LeastThreeBits=7]="LeastThreeBits",e[e.LeastFiveBits=31]="LeastFiveBits",e[e.LeastSixBits=63]="LeastSixBits",e[e.LeastTenBits=1023]="LeastTenBits",e[e.LeastSixteenBits=65535]="LeastSixteenBits"}(I||(I={})),function(e){e[e.SnipeStep=1]="SnipeStep",e[e.Drop=2]="Drop",e[e.TwoAnimalSteps=3]="TwoAnimalSteps"}(x||(x={}));var _=n(3),V={fromString:function(e){var t=JSON.parse(e,(function(e,t){return"initialBoard"===e||"currentBoard"===e?new Int32Array(t):t}));if(14!==t.stateVersion)return y.option.none();return y.option.some(t)},fromBoard:function(e){var t,n=new Int32Array(24),a=Object(_.a)(C);try{for(a.s();!(t=a.n()).done;){var r,i=t.value,o=e[i],l=Object(_.a)(o);try{for(l.s();!(r=l.n()).done;){var s=r.value;if(s.cardType===b.AlphaSnipe||s.cardType===b.BetaSnipe){var u=s.cardType===b.AlphaSnipe?1:2,c=j.Snipes;n[3*i+c]|=u}else{var p=1<<s.cardType,m=s.allegiance===R.Alpha?j.AlphaAnimals:j.BetaAnimals;n[3*i+m]|=p}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){a.e(d)}finally{a.f()}return{stateVersion:14,initialBoard:n,currentBoard:n,turn:R.Beta,plies:[],pendingAnimalStep:0}}};function z(e,t){var n=t-e;return e+Math.floor(n*Math.random())}function U(){var e,t=function(){var e=[b.Mouse1,b.Ox1,b.Rabbit1,b.Snake1,b.Horse1,b.Ram1,b.Monkey1,b.Rooster1,b.Dog1,b.Boar1,b.Squid1,b.Frog1,b.Mouse2,b.Ox2,b.Rabbit2,b.Snake2,b.Horse2,b.Ram2,b.Monkey2,b.Rooster2,b.Dog2,b.Boar2,b.Squid2,b.Frog2],t=[b.Tiger1,b.Dragon1,b.Fish1,b.Elephant1,b.Tiger2,b.Dragon2,b.Fish2,b.Elephant2];G(e),G(t);var n=e.slice(0,12).concat(t.slice(0,4)).map((function(e){return{cardType:e,allegiance:R.Alpha}})),a=e.slice(12).concat(t.slice(4)).map((function(e){return{cardType:e,allegiance:R.Beta}}));return G(n),G(a),{alpha:n,beta:a}}(),n=t.alpha,a=t.beta;return V.fromBoard((e={},Object(d.a)(e,s.AlphaReserve,[n.pop()]),Object(d.a)(e,s.Row1,[n.pop(),{cardType:b.AlphaSnipe,allegiance:R.Alpha},n.pop()]),Object(d.a)(e,s.Row2,[n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop(),n.pop()]),Object(d.a)(e,s.Row3,[n.pop()]),Object(d.a)(e,s.Row4,[a.pop()]),Object(d.a)(e,s.Row5,[a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop(),a.pop()]),Object(d.a)(e,s.Row6,[a.pop(),{cardType:b.BetaSnipe,allegiance:R.Beta},a.pop()]),Object(d.a)(e,s.BetaReserve,[a.pop()]),e))}function G(e){for(var t=e.length,n=0;n<512;n++)for(var a=0;a<=t-2;a++){var r=z(a,t),i=e[a];e[a]=e[r],e[r]=i}}function H(e){return e===s.AlphaReserve||e===s.BetaReserve}function J(e){return D[e].canRetreat}function Y(e){switch(e){case R.Alpha:return R.Beta;case R.Beta:return R.Alpha}}function $(e){switch(e){case R.Alpha:return b.AlphaSnipe;case R.Beta:return b.BetaSnipe}}function K(e,t){return e+(t===R.Alpha?1:-1)}function Z(e,t){return e+(t===R.Alpha?-1:1)}function Q(e){return!(e===s.AlphaReserve||e===s.BetaReserve)}function X(e){switch(e&I.LeastThreeBits){case x.SnipeStep:var t=e>>>3&I.LeastThreeBits;return{plyType:B.SnipeStep,destination:t};case x.Drop:var n=e>>>3&I.LeastFiveBits,a=e>>>8&I.LeastThreeBits;return{plyType:B.Drop,dropped:n,destination:a};case x.TwoAnimalSteps:var r=e>>>3&I.LeastFiveBits,i=e>>>8&I.LeastThreeBits,o=e>>>11&I.LeastFiveBits,l=e>>>16&I.LeastThreeBits;return{plyType:B.TwoAnimalSteps,first:{moved:r,destination:i},second:{moved:o,destination:l}}}}function ee(e){return!("plyType"in e)}var te=n(6);function ne(e){var t=e;return{getInitialState:function(){return{stateVersion:t.stateVersion,initialBoard:t.initialBoard,currentBoard:t.initialBoard,turn:R.Beta,plies:[],pendingAnimalStep:0}},getBoard:function(){var e,n,a=(e={},Object(d.a)(e,s.AlphaReserve,[]),Object(d.a)(e,s.Row1,[]),Object(d.a)(e,s.Row2,[]),Object(d.a)(e,s.Row3,[]),Object(d.a)(e,s.Row4,[]),Object(d.a)(e,s.Row5,[]),Object(d.a)(e,s.Row6,[]),Object(d.a)(e,s.BetaReserve,[]),e),r=Object(_.a)(C);try{var i=function(){var e=n.value,r=a[e],i=t.currentBoard[3*e+j.AlphaAnimals],o=t.currentBoard[3*e+j.BetaAnimals];T.forEach((function(e){0!==(1<<e&i)&&r.push({cardType:e,allegiance:R.Alpha}),0!==(1<<e&o)&&r.push({cardType:e,allegiance:R.Beta})}));var l=t.currentBoard[3*e+j.Snipes];0!==(1<<R.Alpha&l)&&r.push({cardType:b.AlphaSnipe,allegiance:R.Alpha}),0!==(1<<R.Beta&l)&&r.push({cardType:b.BetaSnipe,allegiance:R.Beta})};for(r.s();!(n=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}return a},getPlies:function(){return t.plies.map(X)},getPendingAnimalStep:function(){var e=t.pendingAnimalStep;if(0===e)return y.option.none();var n=e>>>3&I.LeastFiveBits,a=e>>>8&I.LeastThreeBits;return y.option.some({moved:n,destination:a})},isGameOver:function(){return n().isSome()},getWinner:n,getTurn:function(){return t.turn},getCardLocation:u,tryUndoSubPly:function(){if(0===t.plies.length&&0===t.pendingAnimalStep)return y.result.err(k.NothingToUndo);if(0!==t.pendingAnimalStep){var e=S(t);e.pendingAnimalStep=0;var n={moved:t.pendingAnimalStep>>>3&I.LeastFiveBits,destination:t.pendingAnimalStep>>>8&I.LeastThreeBits};return y.result.ok({newState:m(e),undone:n})}var a,r=S(t),i=X(r.plies.pop());if(i.plyType===B.TwoAnimalSteps){var o=i.first.destination<<8|i.first.moved<<3|1;r.pendingAnimalStep=o,a=i.second}else a=i;return y.result.ok({newState:m(r),undone:a})},tryPerform:function(e){return function(e){if(o())return y.option.some(k.SnipeAlreadyCaptured);if(!("plyType"in e)){var n=p(e.moved);if(H(n))return y.option.some(k.MovedCardInReserve);var a=t.currentBoard[3*n+(t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals)];if(!(1<<e.moved&a))return y.option.some(k.NotYourAnimal);if(!h(e.moved,t.turn,e.destination))return y.option.some(k.StepDestinationOutOfRange);if(t.pendingAnimalStep&&(t.pendingAnimalStep>>>3&I.LeastFiveBits)===e.moved)return y.option.some(k.CannotMoveSameAnimalTwice);var r=l(t.currentBoard[3*e.destination+j.AlphaAnimals]|t.currentBoard[3*e.destination+j.BetaAnimals],e.moved),i=t.currentBoard[3*e.destination+j.Snipes],u=t.turn===R.Alpha?1<<R.Beta:1<<R.Alpha,m=i&u,d=t.currentBoard[3*n+j.AlphaAnimals]|t.currentBoard[3*n+j.BetaAnimals],f=t.currentBoard[3*n+j.Snipes],S=d&~(1<<e.moved)|f,v=t.turn===R.Alpha?1<<R.Alpha:1<<R.Beta,A=i&v;return S?r&&A&&!m?y.option.some(k.CannotCaptureOwnSnipeWithoutAlsoCapturingOpponents):y.option.none():r&&m?y.option.none():y.option.some(k.CannotEmptyRowWithoutImmediatelyWinning)}switch(e.plyType){case B.SnipeStep:if(t.pendingAnimalStep)return y.option.some(k.AlreadyMovedAnimal);var g=$(t.turn);if(!h(g,t.turn,e.destination))return y.option.some(k.StepDestinationOutOfRange);var b=c(g),C=t.currentBoard[3*b+j.AlphaAnimals]|t.currentBoard[3*b+j.BetaAnimals],E=t.currentBoard[3*b+j.Snipes],T=t.turn===R.Alpha?1<<R.Beta:1<<R.Alpha;return C|E&T?y.option.none():y.option.some(k.CannotEmptyRowWithoutImmediatelyWinning);case B.Drop:if(t.pendingAnimalStep)return y.option.some(k.AlreadyMovedAnimal);var w=t.currentBoard[3*(t.turn===R.Alpha?s.AlphaReserve:s.BetaReserve)+(t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals)];return 1<<e.dropped&w?w&~(1<<e.dropped)?J(e.dropped)&&!F[t.turn].includes(e.destination)?y.option.some(k.CannotDropRetreaterOnEnemysBackTwoRows):y.option.none():y.option.some(k.CannotEmptyReserve):y.option.some(k.DroppedAnimalNotInReserve)}}(e).match({some:y.result.err,none:function(){return y.result.ok(f(e))}})},serialize:v,toNodeKey:function(){var e=t.currentBoard;return String.fromCharCode(e[0]&I.LeastSixteenBits,e[0]>>>16,e[1]&I.LeastSixteenBits,e[1]>>>16,e[3]&I.LeastSixteenBits,e[3]>>>16,e[4]&I.LeastSixteenBits,e[4]>>>16,e[6]&I.LeastSixteenBits,e[6]>>>16,e[7]&I.LeastSixteenBits,e[7]>>>16,e[9]&I.LeastSixteenBits,e[9]>>>16,e[10]&I.LeastSixteenBits,e[10]>>>16,e[12]&I.LeastSixteenBits,e[12]>>>16,e[13]&I.LeastSixteenBits,e[13]>>>16,e[15]&I.LeastSixteenBits,e[15]>>>16,e[16]&I.LeastSixteenBits,e[16]>>>16,e[18]&I.LeastSixteenBits,e[18]>>>16,e[19]&I.LeastSixteenBits,e[19]>>>16,e[21]&I.LeastSixteenBits,e[21]>>>16,e[22]&I.LeastSixteenBits,e[22]>>>16,e[2]|e[5]<<2|e[8]<<4|e[11]<<6|e[14]<<8|e[17]<<10|e[20]<<12|e[23]<<14,t.turn<<1|t.pendingAnimalStep&I.LeastBit)},setState:function(e){t=e},getLegalAtomics:i,forcePerform:f};function n(){return a()?y.option.some(R.Beta):r()?y.option.some(R.Alpha):0===i().length?y.option.some(Y(t.turn)):y.option.none()}function a(){var e=t.currentBoard[3*s.BetaReserve+j.Snipes];return 0!==(1<<R.Alpha&e)}function r(){var e=t.currentBoard[3*s.AlphaReserve+j.Snipes];return 0!==(1<<R.Beta&e)}function i(){if(o())return[];var e=[];if(0===t.pendingAnimalStep){var n=c($(t.turn)),a=t.currentBoard[3*n+j.AlphaAnimals]|t.currentBoard[3*n+j.BetaAnimals];if(t.currentBoard[3*n+j.Snipes]&1<<Y(t.turn)|a){var r=K(n,t.turn);Q(r)&&e.push({plyType:B.SnipeStep,destination:r});var i=Z(n,t.turn);Q(i)&&e.push({plyType:B.SnipeStep,destination:i})}var u=t.turn===R.Alpha?s.AlphaReserve:s.BetaReserve,p=t.currentBoard[3*u+(t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals)];if(q(p)>1){var m,d=Object(_.a)(T);try{for(d.s();!(m=d.n()).done;){var h=m.value;if(1<<h&p){var f,S=J(h)?F[t.turn]:E,v=Object(_.a)(S);try{for(v.s();!(f=v.n()).done;){var A=f.value;e.push({plyType:B.Drop,dropped:h,destination:A})}}catch(H){v.e(H)}finally{v.f()}}}}catch(H){d.e(H)}finally{d.f()}}}var g,y=Object(_.a)(E);try{for(y.s();!(g=y.n()).done;){var b=g.value,C=t.currentBoard[3*b+(t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals)];if(C){var k,w=t.currentBoard[3*b+j.AlphaAnimals]|t.currentBoard[3*b+j.BetaAnimals],N=t.currentBoard[3*b+j.Snipes],O=q(w)>>>1|N,P=t.turn===R.Alpha?1<<R.Beta:1<<R.Alpha,L=Object(_.a)(T);try{for(L.s();!(k=L.n()).done;){var M=k.value;if((!t.pendingAnimalStep||(t.pendingAnimalStep>>>3&I.LeastFiveBits)!==M)&&1<<M&C)if(O){var x=t.turn===R.Alpha?1<<R.Alpha:1<<R.Beta,D=K(b,t.turn),W=t.currentBoard[3*D+j.Snipes];if(!Q(D)||W&x&&!(W&P)&&l(t.currentBoard[3*D+j.AlphaAnimals]|t.currentBoard[3*D+j.BetaAnimals],M)||e.push({moved:M,destination:D}),J(M)){var V=Z(b,t.turn),z=t.currentBoard[3*V+j.Snipes];!Q(V)||z&x&&!(z&P)&&l(t.currentBoard[3*V+j.AlphaAnimals]|t.currentBoard[3*V+j.BetaAnimals],M)||e.push({moved:M,destination:V})}}else{var U=K(b,t.turn);if(Q(U)&&N&P&&l(t.currentBoard[3*U+j.AlphaAnimals]|t.currentBoard[3*U+j.BetaAnimals],M)&&e.push({moved:M,destination:U}),J(M)){var G=Z(b,t.turn);Q(G)&&N&P&&l(t.currentBoard[3*G+j.AlphaAnimals]|t.currentBoard[3*G+j.BetaAnimals],M)&&e.push({moved:M,destination:G})}}}}catch(H){L.e(H)}finally{L.f()}}}}catch(H){y.e(H)}finally{y.f()}return e}function o(){return a()||r()}function l(e,t){var n,a=D[t].elementCounts,r=Object(_.a)(T);try{for(r.s();!(n=r.n()).done;){var i=n.value;1<<i&e&&(a|=D[i].elementCounts)}}catch(u){r.e(u)}finally{r.f()}var o=Object(te.a)(D[t].tripletShifts,2),l=o[0],s=o[1];return 7===(a>>>l&7)||7===(a>>>s&7)}function u(e){switch(e){case b.AlphaSnipe:case b.BetaSnipe:return c(e);default:return p(e)}}function c(e){var n,a=e===b.AlphaSnipe?1<<R.Alpha:1<<R.Beta,r=Object(_.a)(C);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==(t.currentBoard[3*i+j.Snipes]&a))return i}}catch(o){r.e(o)}finally{r.f()}throw new Error("Impossible: "+b[e]+" cannot be found in "+v())}function p(e){var n,a=1<<e,r=Object(_.a)(C);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==((t.currentBoard[3*i+j.AlphaAnimals]|t.currentBoard[3*i+j.BetaAnimals])&a))return i}}catch(o){r.e(o)}finally{r.f()}throw new Error("Impossible: "+b[e]+" cannot be found in "+v())}function m(e){var t=e,n=ne(t);t.currentBoard=new Int32Array(t.initialBoard);var a=t.plies.map(X),r=t.pendingAnimalStep;if(t.plies=[],t.pendingAnimalStep=0,t.turn=R.Beta,a.forEach((function(e){e.plyType===B.TwoAnimalSteps?(n.setState(t),t=n.forcePerform(e.first),n.setState(t),t=n.forcePerform(e.second)):(n.setState(t),t=n.forcePerform(e))})),r){n.setState(t);var i={moved:r>>>3&I.LeastFiveBits,destination:r>>>8&I.LeastThreeBits};t=n.forcePerform(i)}return t}function h(e,t,n){var a=u(e);return!H(a)&&(K(a,t)===n||J(e)&&Z(a,t)===n)}function f(e){if(!("plyType"in e))return function(e){var n=u(e.moved),a=t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals,r=t.currentBoard[3*e.destination+j.AlphaAnimals]|t.currentBoard[3*e.destination+j.BetaAnimals],i=S(t),o=1<<e.moved,c=~o;if(i.currentBoard[3*n+a]&=c,l(r,e.moved)){var p=t.turn===R.Alpha?s.AlphaReserve:s.BetaReserve,m=t.currentBoard[3*e.destination+j.Snipes],d=t.turn===R.Alpha?j.BetaAnimals:j.AlphaAnimals;i.currentBoard[3*p+a]|=r,i.currentBoard[3*p+j.Snipes]|=m,i.currentBoard[3*e.destination+a]=o,i.currentBoard[3*e.destination+d]=0,i.currentBoard[3*e.destination+j.Snipes]=0}else i.currentBoard[3*e.destination+a]|=o;if(i.pendingAnimalStep){var h=e.destination<<16|e.moved<<11|i.pendingAnimalStep;i.plies.push(h&~I.LeastThreeBits|x.TwoAnimalSteps),i.pendingAnimalStep=0,i.turn=Y(i.turn)}else i.pendingAnimalStep=e.destination<<8|e.moved<<3|1;return i}(e);switch(e.plyType){case B.SnipeStep:return function(e){var n=u($(t.turn)),a=1<<t.turn,r=~a,i=S(t);return i.currentBoard[3*n+j.Snipes]&=r,i.currentBoard[3*e.destination+j.Snipes]|=a,i.plies.push(e.destination<<3|x.SnipeStep),i.turn=Y(i.turn),i}(e);case B.Drop:return function(e){var n=t.turn===R.Alpha?s.AlphaReserve:s.BetaReserve,a=t.turn===R.Alpha?j.AlphaAnimals:j.BetaAnimals,r=1<<e.dropped,i=~r,o=S(t);return o.currentBoard[3*n+a]&=i,o.currentBoard[3*e.destination+a]|=r,o.plies.push(e.destination<<8|e.dropped<<3|x.Drop),o.turn=Y(o.turn),o}(e)}}function S(e){return{stateVersion:e.stateVersion,initialBoard:new Int32Array(e.initialBoard),currentBoard:new Int32Array(e.currentBoard),turn:e.turn,plies:e.plies.slice(),pendingAnimalStep:e.pendingAnimalStep}}function v(){return JSON.stringify(t,(function(e,t){return t instanceof Int32Array?Array.from(t):t}))}}var ae,re,ie=22,oe=Math.sqrt(2);function le(e,t,n){return ne(e).isGameOver()?y.option.none():y.option.some(function(e,t,n){var a=new Int32Array(n),r=0;!function(){if(0!==r)throw new Error("Cannot writeRootState() if heap is not empty.");var n=e.currentBoard,i=e.pendingAnimalStep;a[0]=n[0],a[1]=n[1],a[2]=n[3],a[3]=n[4],a[4]=n[6],a[5]=n[7],a[6]=n[9],a[7]=n[10],a[8]=n[12],a[9]=n[13],a[10]=n[15],a[11]=n[16],a[12]=n[18],a[13]=n[19],a[14]=n[21],a[15]=n[22],a[16]=(0===i?32:i>>>3&I.LeastFiveBits)<<26|t<<16|n[23]<<14|n[20]<<12|n[17]<<10|n[14]<<8|n[11]<<6|n[8]<<4|n[5]<<2|n[2],a[ae.ParentIndex]=-1,a[ae.Atomic]=-1,a[ae.Value]=0,a[ae.Rollouts]=0,a[ae.ChildListStartIndex]=-1,r=22}();var i=se({heapBuffer:a.buffer,mallocIndex:r});return i.performRollout(),i.performRollout(),i}(e,t,n))}function se(e){var t=new Int32Array(e.heapBuffer),n=new Int32Array(17),a=e.mallocIndex;return{performRollout:function(){var e=0;for(;!r(e);)e=i(e);var n=e;if(0===o(n)&&0!==n)s(n);else{var a=v(t,n);~a?(k(n,a),N(n,a)):function(e){for(var n=[],a=u(t.subarray(e,e+17)),r=a.length,i=0;i<r;i++){var o=a[i],l=g(ie);n.push(l),b(e,o,l)}var c=n.length,p=g(1+c);t[e+ae.ChildListStartIndex]=p,t[p]=c;for(var m=0;m<c;m++)t[p+1+m]=n[m];c&&s(n[0])}(n)}},getRootPointer:P,getNodeSummary:L,getChildPointersFromBestToWorst:function(e){for(var n=e,a=t[n+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&I.LeastTenBits,r=1022===a||1023===a?-1:1&a,i=t[n+ae.ChildListStartIndex],o=t[i],l=[],s=0;s<o;s++){var u=t[i+1+s],c=A(u),p=void 0;if(-1!==c&&-1!==r)p=c===r?1/0:-1/0;else if(-1!==c){var m=t[u+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&I.LeastTenBits;p=m===a?1/0:-1/0}else{var d=t[u+ae.Rollouts];p=d}l.push({index:u,score:p})}return l.sort((function(e,t){return t.score-e.score})).map((function(e){return e.index}))},getSnapshot:function(){var e=L(P()),n=function(){var e=function(){for(var e=t[0+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&1,n=1&~e,a=t[0+ae.ChildListStartIndex],r=t[a],i=-1,o=0;o<r;o++){var l=t[a+1+o];if(-1!==i){var s=A(l);if(s===e)return l;s!==n&&(t[l+ae.Rollouts]>t[i+ae.Rollouts]||A(i)===n)&&(i=l)}else i=l}if(-1===i)throw new Error("Impossible: Root node has no children.");return i}();return{pointer:e,atomic:y.option.some(C(t[e+ae.Atomic])),value:t[e+ae.Value],rollouts:t[e+ae.Rollouts]}}();return{currentStateValue:e.value,currentStateRollouts:e.rollouts,bestAtomic:n.atomic.expect("Impossible: Child node does not have atomic."),bestAtomicValue:n.value,bestAtomicRollouts:n.rollouts}},getInternalData:function(){return{heapBuffer:t.buffer,mallocIndex:a}}};function r(e){var n=t[e+ae.ChildListStartIndex];return 0===(0|t[n])}function i(e){var n=t[e+ae.ChildListStartIndex],a=t[n],r=o(e),i=t[e+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16,s=1&i,u=1&~i,c=l(n,0),p=T(c,r);if(A(c)===s)return c;A(c)===u&&(p=-1/0);for(var m=1;m<a;m++){var d=l(n,m),h=A(d);if(h===s)return d;if(h!==u){var f=T(d,r);f>p&&(c=d,p=f)}}return c}function o(e){return t[e+ae.Rollouts]}function l(e,n){return t[e+1+n]}function s(e){var a=v(t,e);~a&&N(e,a),k(e,~a?a:function(e){!function(e){n.set(t.subarray(e,e+17))}(e);var a=u(n);for(;a.length>0;){S(a[z(0,a.length)],n),a=u(n)}return v(n,0)}(e))}function u(e){var t=e[ae.SnipeSetsTurnNumberAndMovedAnimal];if(2&t|t>>>14&1)return[];var n=[],a=t>>>16&1,r=1^a,i=F[a];if(32===c(e)){m(t,a)&&console.log("etc",t);var o=p(t,a);if(Q(o))if(t>>>(o<<1)&1<<r|(e[o<<1|a]|e[o<<1|r])){var l=K(o,a);Q(l)&&n.push({plyType:B.SnipeStep,destination:l,qp_atomicType:re.SnipeStep,qp_activePlayer:a,qp_snipeLocation:o});var s=Z(o,a);Q(s)&&n.push({plyType:B.SnipeStep,destination:s,qp_atomicType:re.SnipeStep,qp_activePlayer:a,qp_snipeLocation:o})}var u=d(a,e);if(q(u)>1)for(var h=0;h<=31;h++)if(1<<h&u)for(var S=J(h)?i:E,v=S.length,A=0;A<v;A++)n.push({plyType:B.Drop,dropped:h,destination:S[A],qp_atomicType:re.Drop,qp_activePlayer:a})}for(var g=1;g<=6;g++){var y=g<<1|a,b=e[y];if(0!==b)for(var C=b|e[(g<<1)+r],R=t>>>(g<<1)&I.LeastTwoBits||q(C)>1,T=t>>>26,k=K(g,a),w=0!==k&&7!==k,N=!w<<1,O=t>>>(k<<1),P=(O&1<<a)>>>N,L=(O&1<<r)>>>N,M=Z(g,a),j=0!==M&&7!==M,x=!j<<1,D=t>>>(M<<1),W=(D&1<<a)>>>x,_=(D&1<<r)>>>x,V=0;V<=31;V++)if(T!==V&&1<<V&b){var z=f(k,V,e),U=J(V),G=U&&f(M,V,e);R?(!w||P&&!L&&z||n.push({moved:V,destination:k,qp_atomicType:re.AnimalStep,qp_startIndex:y,qp_activePlayer:a,qp_inactivePlayer:r,qp_doesStepActivateTriplet:z}),U&&(!j||W&&!_&&G||n.push({moved:V,destination:M,qp_atomicType:re.AnimalStep,qp_startIndex:y,qp_activePlayer:a,qp_inactivePlayer:r,qp_doesStepActivateTriplet:G}))):(w&&L&&z&&n.push({moved:V,destination:k,qp_atomicType:re.AnimalStep,qp_startIndex:y,qp_activePlayer:a,qp_inactivePlayer:r,qp_doesStepActivateTriplet:z}),G&&j&&_&&n.push({moved:V,destination:M,qp_atomicType:re.AnimalStep,qp_startIndex:y,qp_activePlayer:a,qp_inactivePlayer:r,qp_doesStepActivateTriplet:G}))}}return n}function c(e){return e[ae.SnipeSetsTurnNumberAndMovedAnimal]>>>26}function p(e,t){for(var n=1<<t,a=0;a<=14;a+=2)if(e>>>a&n)return a>>>1;throw new Error("Impossible: "+R[t]+" snipe cannot be found.")}function m(e,t){for(var n=1<<t,a=0;a<=14;a+=2)if(e>>>a&n)return!1;return!0}function d(e,t){return t[h(e)]}function h(e){return e===R.Alpha?0:15}function f(e,t,n){for(var a=n[e<<1]|n[1+(e<<1)],r=D[t].elementCounts,i=0;i<=31;i++)1<<i&a&&(r|=D[i].elementCounts);var o=Object(te.a)(D[t].tripletShifts,2),l=o[0],s=o[1];return 7===(r>>>l&7)||7===(r>>>s&7)}function S(e,t){return e.qp_atomicType===re.SnipeStep?function(e,t){var n=t[ae.SnipeSetsTurnNumberAndMovedAnimal],a=1<<e.qp_activePlayer;t[ae.SnipeSetsTurnNumberAndMovedAnimal]&=~(a<<(e.qp_snipeLocation<<1)),t[ae.SnipeSetsTurnNumberAndMovedAnimal]|=a<<(e.destination<<1);var r=t[ae.SnipeSetsTurnNumberAndMovedAnimal];(m(r,0)||m(r,1))&&console.log("before",n,"after",r,"was already broken",m(n,0)||m(n,1),"atomic",e);var i=t[ae.SnipeSetsTurnNumberAndMovedAnimal],o=i>>>16&I.LeastTenBits;t[ae.SnipeSetsTurnNumberAndMovedAnimal]=4227923967&i|o+1<<16}(e,t):e.qp_atomicType===re.Drop?function(e,t){var n=h(e.qp_activePlayer),a=1<<e.dropped;t[n]&=~a,t[(e.destination<<1)+e.qp_activePlayer]|=a;var r=t[ae.SnipeSetsTurnNumberAndMovedAnimal],i=r>>>16&I.LeastTenBits;t[ae.SnipeSetsTurnNumberAndMovedAnimal]=4227923967&r|i+1<<16}(e,t):function(e,t){var n=e.qp_startIndex,a=1<<e.moved;t[n]&=~a;var r=e.destination<<1;if(e.qp_doesStepActivateTriplet){t[h(e.qp_activePlayer)]|=t[r]|t[1|r],t[r|e.qp_activePlayer]=a,t[r|e.qp_inactivePlayer]=0;var i=t[ae.SnipeSetsTurnNumberAndMovedAnimal],o=i>>>r&I.LeastTwoBits;t[ae.SnipeSetsTurnNumberAndMovedAnimal]=i&~(3<<r)|o<<(e.qp_activePlayer?14:0)}else t[r|e.qp_activePlayer]|=a;var l=t[ae.SnipeSetsTurnNumberAndMovedAnimal];t[ae.SnipeSetsTurnNumberAndMovedAnimal]=l>>>31?67108863&l|e.moved<<26:4227923967&(67108863&l|2147483648)|1+(l>>>16&I.LeastTenBits)<<16}(e,t)}function v(e,t){var n=e[t+ae.SnipeSetsTurnNumberAndMovedAnimal];return 2&n?R.Alpha:n>>>14&1?R.Beta:function(e){var t=e[ae.SnipeSetsTurnNumberAndMovedAnimal];if(2&t|t>>>14&1)return!1;var n=t>>>16&1,a=1^n,r=F[n];if(32===c(e)){m(t,n)&&console.log("etc",t);var i=p(t,n);if(Q(i)){var o=t>>>(i<<1)&1<<a,l=e[i<<1|n]|e[i<<1|a];if(o|l){if(Q(K(i,n)))return!0;if(Q(Z(i,n)))return!0}}var s=d(n,e);if(q(s)>1)for(var u=0;u<=31;u++)if(1<<u&s)for(var h=(J(u)?r:E).length,S=0;S<h;S++)return!0}for(var v=1;v<=6;v++){var A=e[v<<1|n];if(0!==A)for(var g=A|e[(v<<1)+a],y=t>>>(v<<1)&I.LeastTwoBits||q(g)>1,b=t>>>26,C=K(v,n),R=0!==C&&7!==C,T=!R<<1,B=t>>>(C<<1),k=(B&1<<n)>>>T,w=(B&1<<a)>>>T,N=Z(v,n),O=0!==N&&7!==N,P=!O<<1,L=t>>>(N<<1),M=(L&1<<n)>>>P,j=(L&1<<a)>>>P,x=0;x<=31;x++)if(b!==x&&1<<x&A){var D=f(C,x,e),W=J(x),_=W&&f(N,x,e);if(y){if(R&&(!k||w||!D))return!0;if(W&&O&&(!M||j||!_))return!0}else{if(R&&w&&D)return!0;if(_&&O&&j)return!0}}}return!1}(e.subarray(t,t+17))?-1:1&~(n>>>16)}function A(e){var n=t[e+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&I.LeastTenBits;return 1022===n?R.Alpha:1023===n?R.Beta:-1}function g(e){if(a>t.length-e)throw new Error("Monte Carlo Tree heap has ran out of space.");var n=a;return a+=e,n}function b(e,n,a){t.set(t.subarray(e,e+17),a),t[a+ae.ParentIndex]=e,t[a+ae.Atomic]=function(e){return e.qp_atomicType===re.SnipeStep?e.destination<<3|1:e.qp_atomicType===re.Drop?e.destination<<8|e.dropped<<3|2:e.destination<<8|e.moved<<3|3}(n),t[a+ae.Value]=0,t[a+ae.Rollouts]=0,t[a+ae.ChildListStartIndex]=-1,S(n,t.subarray(a,a+17))}function C(e){var t=e&I.LeastThreeBits;return 1===t?{plyType:B.SnipeStep,destination:e>>>3}:2===t?{plyType:B.Drop,dropped:e>>>3&I.LeastFiveBits,destination:e>>>8}:{moved:e>>>3&I.LeastFiveBits,destination:e>>>8}}function T(e,n){var a=o(e);return 0===a?1/0:function(e){return t[e+ae.Value]}(e)/a+oe*Math.sqrt(Math.log(n)/a)}function k(e,n){for(var a=e,r=t[a+ae.ParentIndex];~r;)t[a+ae.Value]+=n===w(r),t[a+ae.Rollouts]+=1,r=t[(a=r)+ae.ParentIndex];t[a+ae.Value]+=n===w(a),t[a+ae.Rollouts]+=1}function w(e){return t[e+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&1}function N(e,n){for(var a=(1022|n)<<16,r=e,i=O(r);~i&&(t[i+ae.SnipeSetsTurnNumberAndMovedAnimal]>>>16&1)===n;){var o=r+ae.SnipeSetsTurnNumberAndMovedAnimal,l=t[o];t[o]=4227923967&l|a,i=O(r=i)}var s=r+ae.SnipeSetsTurnNumberAndMovedAnimal,u=t[s];t[s]=4227923967&u|a}function O(e){return t[e+ae.ParentIndex]}function P(){return 0}function L(e){var n=e;return{pointer:e,atomic:-1===t[n+ae.ParentIndex]?y.option.none():y.option.some(C(t[n+ae.Atomic])),value:t[n+ae.Value],rollouts:t[n+ae.Rollouts]}}}function ue(e){return e}function ce(e){return e}!function(e){e[e.SnipeSetsTurnNumberAndMovedAnimal=16]="SnipeSetsTurnNumberAndMovedAnimal",e[e.ParentIndex=17]="ParentIndex",e[e.Atomic=18]="Atomic",e[e.Value=19]="Value",e[e.Rollouts=20]="Rollouts",e[e.ChildListStartIndex=21]="ChildListStartIndex"}(ae||(ae={})),function(e){e[e.SnipeStep=0]="SnipeStep",e[e.Drop=1]="Drop",e[e.AnimalStep=2]="AnimalStep"}(re||(re={}));var pe;n(26);function me(e){var t=e.atomic,n=e.plyNumber,a=e.ellipsis,r=de(n%2===0?b.AlphaSnipe:b.BetaSnipe);if(ee(t))switch(a){case pe.Before:return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"InlinePlyNumber"},r+n,".")," ...",de(t.moved),t.destination);case pe.After:return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"InlinePlyNumber"},r+n,".")," ",de(t.moved),t.destination,", ...");case pe.None:return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"InlinePlyNumber"},r+n,".")," ",de(t.moved),t.destination)}else switch(t.plyType){case B.SnipeStep:return c.a.createElement(c.a.Fragment,null," ",c.a.createElement("div",{className:"InlinePlyNumber"},r+n,".")," ",r,t.destination);case B.Drop:return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"InlinePlyNumber"},r+n,".")," !",de(t.dropped),t.destination)}}function de(e){return W[e]}!function(e){e[e.Before=0]="Before",e[e.After=1]="After",e[e.None=2]="None"}(pe||(pe={}));n(27);function he(e){var t=e.value,n=e.rollouts,a=t/n;return c.a.createElement("div",{className:"NodeStats"},"[v\u0305 = ",a.toFixed(3),", n = ",n,"]")}function fe(e){var t=e.analyzer,n=e.suggestionDetailLevels,a=e.plyNumber,r=e.isTherePendingAnimalStep,i=e.viewedNode,o=e.onDetailLevelChange,s=n[i.pointer],u=void 0===s?l.None:s,p=function(){var e=t.getChildPointersFromBestToWorst(i.pointer);switch(u){case l.None:return[];case l.BestAction:return e.slice(0,1);case l.AllActions:return e}}();return c.a.createElement("div",null,i.atomic.match({none:function(){return"Current state:"},some:function(e){return c.a.createElement(me,{atomic:e,plyNumber:a,ellipsis:r?pe.Before:pe.After})}})," ",c.a.createElement(he,{value:i.value,rollouts:i.rollouts})," ",c.a.createElement(Se,{pointer:i.pointer,detailLevel:u,onChange:o}),c.a.createElement("ol",null,p.map((function(e,l){var s=t.getNodeSummary(e),u=i.atomic.someSatisfies(ee)?r?{plyNumberAfterPerformingChildAtomic:a+1,isTherePendingAnimalStepAfterPerformingChildAtomic:!1}:{plyNumberAfterPerformingChildAtomic:a,isTherePendingAnimalStepAfterPerformingChildAtomic:!0}:{plyNumberAfterPerformingChildAtomic:a+1,isTherePendingAnimalStepAfterPerformingChildAtomic:!1},p=u.plyNumberAfterPerformingChildAtomic,m=u.isTherePendingAnimalStepAfterPerformingChildAtomic;return c.a.createElement("li",{key:l},c.a.createElement(fe,{analyzer:t,suggestionDetailLevels:n,plyNumber:p,isTherePendingAnimalStep:m,viewedNode:s,onDetailLevelChange:o}))}))))}function Se(e){var t=e.pointer,n=e.detailLevel,a=e.onChange;return c.a.createElement(c.a.Fragment,null,"Display"," ",c.a.createElement("select",{value:n,onChange:function(e){var n=e.target.value;a(t,n)}},c.a.createElement("option",{value:l.None},"no actions"),c.a.createElement("option",{value:l.BestAction},"best action"),c.a.createElement("option",{value:l.AllActions},"all actions")))}n(12);function ve(e){var t=e.step,n=e.plyNumber,a=e.winner,r=Ae(n%2===0?b.AlphaSnipe:b.BetaSnipe);return c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},r+n,".")," ",Ae(t.moved),t.destination,a.match({some:function(e){return", "+W[$(e)]+">"+W[$(Y(e))]},none:function(){return", ..."}}))}function Ae(e){return W[e]}n(28);function ge(e){var t=e.card,n=e.isSelected,a=e.onCardClicked;return c.a.createElement("div",{className:"CardView"+(t.allegiance===R.Alpha?" CardView--alpha":" CardView--beta")+(n?" CardView--selected":"")+(J(t.cardType)?" CardView--canMoveBackward":""),onClick:function(){return a(t)}},W[t.cardType])}n(29);function ye(e){e.analyzer;var t=e.cards,n=e.selectedCard,a=e.onCardClicked;return c.a.createElement("table",{className:"ElementMatrix"},c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement(r,{amount:1,element:w.Fire}),c.a.createElement(r,{amount:1,element:w.Water}),c.a.createElement(r,{amount:1,element:w.Earth}),c.a.createElement(r,{amount:1,element:w.Air})),c.a.createElement("tr",null,c.a.createElement(r,{amount:2,element:w.Fire}),c.a.createElement(r,{amount:2,element:w.Water}),c.a.createElement(r,{amount:2,element:w.Earth}),c.a.createElement(r,{amount:2,element:w.Air})),c.a.createElement("tr",null,c.a.createElement(r,{amount:3,element:w.Fire}),c.a.createElement(r,{amount:3,element:w.Water}),c.a.createElement(r,{amount:3,element:w.Earth}),c.a.createElement(r,{amount:3,element:w.Air}))));function r(e){var n=e.amount,a=e.element,r=function(e,t,n){return e.filter((function(e){return function(e,t){return D[e].elements.match({none:function(){return 0},some:function(e){var n=e.double,a=e.single;return n===a?n===t?3:0:n===t?2:a===t?1:0}})}(e.cardType,n)===t}))}(t,n,a);return c.a.createElement("td",{className:"ElementMatrixCell"+(0===r.length?" ElementMatrixCell--empty":"")},r.map(i))}function i(e){var t=n.unwrapOr(null)===e.cardType;return c.a.createElement(ge,{key:e.cardType,card:e,isSelected:t,onCardClicked:a})}}function be(e){var t=e.step,n=e.plyNumber,a=Ce(n%2===0?b.AlphaSnipe:b.BetaSnipe);return c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},a+n,".")," ...",Ce(t.moved),t.destination)}function Ce(e){return W[e]}n(30);function Ee(e){var t=e.ply,n=e.plyNumber,a=Re(n%2===0?b.AlphaSnipe:b.BetaSnipe);switch(t.plyType){case B.SnipeStep:return c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},a+n,".")," ",a,t.destination);case B.Drop:return c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},a+n,".")," !",Re(t.dropped),t.destination);case B.TwoAnimalSteps:return c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},a+n,".")," ",Re(t.first.moved),t.first.destination,", ",Re(t.second.moved),t.second.destination)}}function Re(e){return W[e]}var Te,Be=n(16),ke=n.n(Be).a;function we(){var e=new ke,t=[],n=[],a=[];return e.addEventListener("message",r),{updateGameState:function(t,n){var a=n.unwrapOr(1/0),r={messageType:P.UpdateGameStateRequest,gameState:t,thinkingTimeInMS:a};e.postMessage(r)},pause:function(){var t={messageType:P.PauseAnalyzerRequest};e.postMessage(t)},resume:function(t){var n=t.getInternalData(),a={messageType:P.ResumeAnalyzerRequest,internalData:n};e.postMessage(a,[n.heapBuffer])},onSnapshot:function(e){t.push(e)},onPause:function(e){n.push(e)},onStopTimeChange:function(e){a.push(e)}};function r(e){var r=e.data;if(null!==r&&"object"===typeof r){var i=r;switch(i.messageType){case P.LogNotification:!function(e){console.log("MCTS Worker Log:",e.data)}(i);break;case P.UpdateSnapshotNotification:!function(e){var n,a=y.option.fromVoidable(e.optSnapshot),r=Object(_.a)(t);try{for(r.s();!(n=r.n()).done;){(0,n.value)(a)}}catch(i){r.e(i)}finally{r.f()}}(i);break;case P.PauseAnalyzerResponse:!function(e){var t,a=se(e.internalData),r=Object(_.a)(n);try{for(r.s();!(t=r.n()).done;){(0,t.value)(a)}}catch(i){r.e(i)}finally{r.f()}}(i);break;case P.StopTimeChangeNotification:!function(e){var t,n=y.option.fromVoidable(e.optStopTime),r=Object(_.a)(a);try{for(r.s();!(t=r.n()).done;){(0,t.value)(n)}}catch(i){r.e(i)}finally{r.f()}}(i);break;default:}}}}!function(e){e.GameState="GameState",e.FutureSubPlyStack="FutureSubPlyStack",e.ThinkingTimeInMilliseconds="ThinkingTimeInMilliseconds"}(Te||(Te={}));var Ne=function(){var e=localStorage.getItem(Te.GameState);return null===e?y.option.none():V.fromString(e)},Oe=function(e){var t=ne(e).serialize();localStorage.setItem(Te.GameState,t)},Pe=function(){var e=localStorage.getItem(Te.FutureSubPlyStack);if(null===e)return y.option.none();var t=JSON.parse(e);return 14!==t.stateVersion?y.option.none():(t.pendingAnimalStep=y.option.fromVoidable(t.pendingAnimalStep),y.option.some(t))},Le=function(e){var t={stateVersion:e.stateVersion,atomics:e.atomics},n=JSON.stringify(t);localStorage.setItem(Te.FutureSubPlyStack,n)},Me=function(){var e=localStorage.getItem(Te.ThinkingTimeInMilliseconds);if(null===e)return y.option.none();var t=JSON.parse(e),n=y.option.fromVoidable(t);return y.option.some(n)},Fe=function(e){var t=JSON.stringify(e.unwrapOr(null));localStorage.setItem(Te.ThinkingTimeInMilliseconds,t)},je=function(e){Object(A.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(f.a)(this,n),(a=t.call(this,e)).mctsService=void 0,a.state=function(){var e=Ne().unwrapOrElse((function(){var e=U();return Oe(e),e})),t=Pe().unwrapOrElse((function(){var e={stateVersion:14,atomics:[]};return Le(e),e})),n=Me().unwrapOrElse((function(){return y.option.none()}));return{gameState:e,ux:{selectedCardType:y.option.none(),futureSubPlyStack:t,analysisSuggestionDetailLevels:{}},mctsState:{isRunning:!0,mostRecentSnapshot:y.option.none()},thinkingTimeInMS:n,thinkingTimeInputValue:n.match({none:function(){return""},some:function(e){return""+.001*e}}),stopTime:y.option.none()}}(),a.bindMethods(),window.app=Object(v.a)(a),a.mctsService=we(),a}return Object(S.a)(n,[{key:"componentDidMount",value:function(){this.mctsService.updateGameState(this.state.gameState,this.state.thinkingTimeInMS),this.mctsService.onSnapshot(this.onMctsServiceSnapshot),this.mctsService.onPause(this.onMctsServicePause),this.mctsService.onStopTimeChange(this.onMctsServiceOnStopTimeChange)}},{key:"bindMethods",value:function(){this.onCardClicked=this.onCardClicked.bind(this),this.onResetGameClicked=this.onResetGameClicked.bind(this),this.onUndoSubPlyClicked=this.onUndoSubPlyClicked.bind(this),this.onRedoSubPlyClicked=this.onRedoSubPlyClicked.bind(this),this.isBestAtomicLegal=this.isBestAtomicLegal.bind(this),this.onMctsServiceSnapshot=this.onMctsServiceSnapshot.bind(this),this.onMctsServicePause=this.onMctsServicePause.bind(this),this.onPauseAnalyzerClicked=this.onPauseAnalyzerClicked.bind(this),this.onResumeAnalyzerClicked=this.onResumeAnalyzerClicked.bind(this),this.onDetailLevelChange=this.onDetailLevelChange.bind(this),this.onTimeLimitEnabledChange=this.onTimeLimitEnabledChange.bind(this),this.onThinkingTimeInputChange=this.onThinkingTimeInputChange.bind(this),this.onMctsServiceOnStopTimeChange=this.onMctsServiceOnStopTimeChange.bind(this)}},{key:"saveAndUpdateGameState",value:function(e){Oe(e),this.setState({gameState:e}),this.mctsService.updateGameState(e,this.state.thinkingTimeInMS)}},{key:"render",value:function(){return this.renderMatrixView()}},{key:"renderMatrixView",value:function(){var e=this,t=ne(this.state.gameState),n=ne(t.getInitialState()).getBoard(),a=t.getBoard(),r=t.getPlies(),i=this.state.mctsState,o=this.state.ux.selectedCardType;return c.a.createElement("div",{className:"SnipeHunt"+this.state.thinkingTimeInMS.match({none:function(){return""},some:function(){return" SnipeHunt--timed"}})},this.state.thinkingTimeInMS.match({none:function(){return null},some:function(){return c.a.createElement("div",{className:"SnipeHunt__TopTimer"},c.a.createElement("label",null,"Seconds remaining for this turn:"," ",c.a.createElement("span",null,e.state.stopTime.match({none:function(){return"Loading..."},some:function(t){var n=t-Date.now(),a=Math.ceil(.001*n);return Math.max(0,a)+"/"+e.state.thinkingTimeInputValue}}))))}}),c.a.createElement("div",{className:"SnipeHunt__Main"},t.getWinner().match({none:function(){return c.a.createElement("div",null,"Turn: ",R[t.getTurn()])},some:function(e){return c.a.createElement("div",null,"Winner: ",R[e])}}),c.a.createElement("div",null,c.a.createElement("table",{className:"Board"},c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell"},"Reserve",this.renderSnipesIn(a[s.AlphaReserve])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.AlphaReserve],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(1)}},"1",this.renderSnipesIn(a[s.Row1])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row1],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(2)}},"2",this.renderSnipesIn(a[s.Row2])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row2],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(3)}},"3",this.renderSnipesIn(a[s.Row3])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row3],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(4)}},"4",this.renderSnipesIn(a[s.Row4])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row4],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(5)}},"5",this.renderSnipesIn(a[s.Row5])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row5],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell",onClick:function(t){t.target instanceof HTMLTableCellElement&&t.target.classList.contains("BoardCell")&&e.onRowNumberClicked(6)}},"6",this.renderSnipesIn(a[s.Row6])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.Row6],selectedCard:o,onCardClicked:this.onCardClicked}))),c.a.createElement("tr",null,c.a.createElement("td",{className:"BoardCell"},"Reserve",this.renderSnipesIn(a[s.BetaReserve])),c.a.createElement("td",{className:"BoardCell"},c.a.createElement(ye,{analyzer:t,cards:a[s.BetaReserve],selectedCard:o,onCardClicked:this.onCardClicked})))))),c.a.createElement("div",null,c.a.createElement("h3",null,"Plies"),c.a.createElement("ol",{className:"Plies"},c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},W[b.BetaSnipe]+"1",".")," ","=",n[s.BetaReserve].map((function(e){return W[e.cardType]})),";"," ",n[s.Row6].map((function(e){return W[e.cardType]})),";"," ",n[s.Row5].map((function(e){return W[e.cardType]})),";"," ",n[s.Row4].map((function(e){return W[e.cardType]}))),c.a.createElement("li",null,c.a.createElement("div",{className:"PlyNumber"},W[b.AlphaSnipe]+"2",".")," ","=",n[s.AlphaReserve].map((function(e){return W[e.cardType]})),";"," ",n[s.Row1].map((function(e){return W[e.cardType]})),";"," ",n[s.Row2].map((function(e){return W[e.cardType]})),";"," ",n[s.Row3].map((function(e){return W[e.cardType]}))),r.map((function(e,t){var n=t+3;return c.a.createElement(Ee,{ply:e,plyNumber:n})})),t.getPendingAnimalStep().match({none:function(){return null},some:function(e){return c.a.createElement(ve,{step:e,plyNumber:r.length+3,winner:t.getWinner()})}}),t.getWinner().match({none:function(){return null},some:function(e){return W[$(e)]+">"+W[$(Y(e))]}})),c.a.createElement("h4",null,"Future sub plies"),c.a.createElement("ol",{className:"Plies"},this.renderFutureSubPlies()),c.a.createElement("button",{onClick:this.onUndoSubPlyClicked},"Back"),c.a.createElement("button",{onClick:this.onRedoSubPlyClicked},"Forward")),c.a.createElement("button",{onClick:this.onResetGameClicked},"Reset"),c.a.createElement("div",null,c.a.createElement("h3",null,"MCTS"," ",i.isRunning?c.a.createElement("button",{onClick:this.onPauseAnalyzerClicked},"Pause"):c.a.createElement("button",{onClick:this.onResumeAnalyzerClicked},"Resume")),c.a.createElement("div",null,this.state.thinkingTimeInMS.match({none:function(){return c.a.createElement("div",null,c.a.createElement("h4",{className:"Inline"},"Time limit")," ",c.a.createElement("input",{type:"checkbox",checked:!1,onChange:e.onTimeLimitEnabledChange}))},some:function(t){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("label",null,c.a.createElement("h4",{className:"Inline"},"Time limit")," ",c.a.createElement("input",{type:"checkbox",checked:!0,onChange:e.onTimeLimitEnabledChange}))),c.a.createElement("div",null,c.a.createElement("label",null,"Seconds per turn:"," ",c.a.createElement("input",{type:"text",className:De(e.state.thinkingTimeInputValue)?"":"InvalidNumber",value:e.state.thinkingTimeInputValue,onChange:e.onThinkingTimeInputChange}))),c.a.createElement("div",null,c.a.createElement("label",null,"Seconds remaining for this turn:"," ",c.a.createElement("span",null,e.state.stopTime.match({none:function(){return"Loading..."},some:function(e){var t=e-Date.now(),n=Math.ceil(.001*t);return""+Math.max(0,n)}})))))}})),i.isRunning?i.mostRecentSnapshot.match({none:function(){return t.isGameOver()?c.a.createElement("p",null,"Game over"):c.a.createElement("p",null,"Loading...")},some:function(e){var n=e.bestAtomic,a=ne(t.forcePerform(n)),i=e.currentStateValue/e.currentStateRollouts,o=e.bestAtomicValue/e.bestAtomicRollouts;return c.a.createElement(c.a.Fragment,null,c.a.createElement("h4",null,"Best action (before: [v\u0305 ="," ",i.toFixed(3),", n ="," ",e.currentStateRollouts,"], after: [v\u0305 = ",o.toFixed(3),", n ="," ",e.bestAtomicRollouts,"]):"),"plyType"in n?c.a.createElement(Ee,{ply:n,plyNumber:r.length+3}):t.getPendingAnimalStep().isSome()?c.a.createElement(be,{step:n,plyNumber:r.length+3}):c.a.createElement(ve,{step:n,plyNumber:r.length+3,winner:a.getWinner()}))}}):this.renderExpandableAnalysis(i,r.length+2))))}},{key:"renderSnipesIn",value:function(e){var t=this,n=this.state.ux.selectedCardType.map((function(e){return e}));return e.filter((function(e){return e.cardType===b.AlphaSnipe||e.cardType===b.BetaSnipe})).map((function(e){var a=n.equalsSome(e.cardType);return c.a.createElement(ge,{key:e.cardType,card:e,isSelected:a,onCardClicked:t.onCardClicked})}))}},{key:"renderTraditionalView",value:function(){var e=this,t=ne(this.state.gameState),n=t.getBoard();return c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,"Reserve"),c.a.createElement("td",{className:t.isGameOver()?"":t.getTurn()===R.Alpha?"TurnIndicatorLight":""}),c.a.createElement("td",null,this.renderCards(n[s.AlphaReserve]))),c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(1)}},"1"),c.a.createElement("td",null,this.renderCards(n[s.Row1].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row1].filter(Ie)))),c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(2)}},"2"),c.a.createElement("td",null,this.renderCards(n[s.Row2].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row2].filter(Ie))))," ",c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(3)}},"3"),c.a.createElement("td",null,this.renderCards(n[s.Row3].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row3].filter(Ie))))," ",c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(4)}},"4"),c.a.createElement("td",null,this.renderCards(n[s.Row4].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row4].filter(Ie))))," ",c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(5)}},"5"),c.a.createElement("td",null,this.renderCards(n[s.Row5].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row5].filter(Ie))))," ",c.a.createElement("tr",null,c.a.createElement("td",{onClick:function(){return e.onRowNumberClicked(6)}},"6"),c.a.createElement("td",null,this.renderCards(n[s.Row6].filter(xe))),c.a.createElement("td",null,this.renderCards(n[s.Row6].filter(Ie)))),c.a.createElement("tr",null,c.a.createElement("td",null,"Reserve"),c.a.createElement("td",{className:t.isGameOver()?"":t.getTurn()===R.Beta?"TurnIndicatorLight":""}),c.a.createElement("td",null,this.renderCards(n[s.BetaReserve])))))}},{key:"renderCards",value:function(e){var t=this;return e.map((function(e){return c.a.createElement(ge,{key:e.cardType,card:e,isSelected:t.state.ux.selectedCardType.match({none:function(){return!1},some:function(t){return t===e.cardType}}),onCardClicked:function(){return t.onCardClicked(e)}})}))}},{key:"renderFutureSubPlies",value:function(){for(var e=this.state.ux.futureSubPlyStack.atomics.slice().reverse(),t=y.option.none(),n=[],a=y.option.none(),r=0;r<e.length;){var i=e[r];if("plyType"in i)n.push(i),r++;else if(r+1<e.length){var o=e[++r];"plyType"in o?(t=y.option.some(i),n.push(o),r++):(n.push({plyType:B.TwoAnimalSteps,first:i,second:o}),r++)}else a=y.option.some(i),r++}var l=this.state.gameState.plies,s=ne(this.state.gameState);return c.a.createElement(c.a.Fragment,null,t.match({none:function(){return null},some:function(e){return c.a.createElement(be,{step:e,plyNumber:l.length+3})}}),n.map((function(e,n){return c.a.createElement(Ee,{ply:e,plyNumber:l.length+3+t.match({none:function(){return 0},some:function(){return 1}})+n})})),a.match({none:function(){return null},some:function(e){return c.a.createElement(ve,{step:e,plyNumber:l.length+3+t.match({none:function(){return 0},some:function(){return 1}})+n.length,winner:ne(s.forcePerform(e)).getWinner()})}}))}},{key:"renderExpandableAnalysis",value:function(e,t){var n=ne(this.state.gameState).getPendingAnimalStep().isSome(),a=e.analyzer,r=a.getNodeSummary(a.getRootPointer());return c.a.createElement(fe,{analyzer:a,suggestionDetailLevels:this.state.ux.analysisSuggestionDetailLevels,plyNumber:t,isTherePendingAnimalStep:n,viewedNode:r,onDetailLevelChange:this.onDetailLevelChange})}},{key:"onCardClicked",value:function(e){var t=ne(this.state.gameState);e.allegiance===t.getTurn()&&(this.state.ux.selectedCardType.someSatisfies((function(t){return t===e.cardType}))?this.updateUxState({selectedCardType:y.option.none()}):this.updateUxState({selectedCardType:y.option.some(e.cardType)}))}},{key:"updateUxState",value:function(e){this.setState((function(t){var n=Object(h.a)(Object(h.a)({},t),{},{ux:Object(h.a)(Object(h.a)({},t.ux),e)});return Le(n.ux.futureSubPlyStack),n}))}},{key:"onRowNumberClicked",value:function(e){var t=this,n=ne(this.state.gameState);n.isGameOver()||this.state.ux.selectedCardType.ifSome((function(a){t.updateUxState({futureSubPlyStack:{stateVersion:14,atomics:t.state.ux.futureSubPlyStack.atomics.slice(0,-1)}}),H(n.getCardLocation(a))?t.tryDrop(a,e):a===b.AlphaSnipe||a===b.BetaSnipe?t.trySnipeStep(e):t.tryAnimalStep(a,e)}))}},{key:"tryDrop",value:function(e,t){var n=ne(this.state.gameState),a={plyType:B.Drop,dropped:e,destination:t},r=n.tryPerform(a);this.updateGameStateOrAlertError(r)}},{key:"updateGameStateOrAlertError",value:function(e){var t=this;e.match({ok:function(e){t.saveAndUpdateGameState(e),t.updateUxState({selectedCardType:y.option.none()})},err:function(e){alert(k[e]),t.updateUxState({selectedCardType:y.option.none()})}})}},{key:"trySnipeStep",value:function(e){var t=ne(this.state.gameState),n={plyType:B.SnipeStep,destination:e},a=t.tryPerform(n);this.updateGameStateOrAlertError(a)}},{key:"tryAnimalStep",value:function(e,t){var n={moved:e,destination:t},a=ne(this.state.gameState).tryPerform(n);this.updateGameStateOrAlertError(a)}},{key:"onUndoSubPlyClicked",value:function(){var e=this;ne(this.state.gameState).tryUndoSubPly().match({ok:function(t){var n=t.newState,a=t.undone;e.updateUxState({futureSubPlyStack:e.getFutureSubPlyStackAfterUndoing(a)}),e.saveAndUpdateGameState(n)},err:function(e){alert(k[e])}})}},{key:"getFutureSubPlyStackAfterUndoing",value:function(e){var t=this.state.ux.futureSubPlyStack;return{stateVersion:t.stateVersion,atomics:t.atomics.concat([e])}}},{key:"onRedoSubPlyClicked",value:function(){var e=this,t=this.state.ux.futureSubPlyStack,n=t.atomics;if(0!==n.length){var a=n[n.length-1],r=ne(this.state.gameState).tryPerform(a);this.updateGameStateOrAlertError(r),r.ifOk((function(){e.updateUxState({futureSubPlyStack:{stateVersion:t.stateVersion,atomics:n.slice(0,-1)}})}))}else alert("Nothing to redo.")}},{key:"onResetGameClicked",value:function(){if(window.confirm("Are you sure you want to reset?")){var e=U(),t={gameState:e,ux:{selectedCardType:y.option.none(),futureSubPlyStack:{stateVersion:14,atomics:[]},analysisSuggestionDetailLevels:{}},mctsState:{isRunning:!0,mostRecentSnapshot:y.option.none()},thinkingTimeInMS:y.option.none(),thinkingTimeInputValue:"",stopTime:y.option.none()};Oe(e),Le(t.ux.futureSubPlyStack),Fe(t.thinkingTimeInMS),this.setState(t),this.mctsService.updateGameState(e,t.thinkingTimeInMS)}}},{key:"isBestAtomicLegal",value:function(e){var t=e.bestAtomic,n=ne(this.state.gameState).tryPerform(t).isOk();return n||console.log("outdated best atomic",t),n}},{key:"onMctsServiceSnapshot",value:function(e){this.state.mctsState.isRunning&&this.setState({mctsState:{isRunning:!0,mostRecentSnapshot:e.filter(this.isBestAtomicLegal)}})}},{key:"onMctsServicePause",value:function(e){this.setState({mctsState:{isRunning:!1,analyzer:e,expandedNodeIndexes:[]}}),this.resetAnalysisSuggestionDetailLevels(e)}},{key:"resetAnalysisSuggestionDetailLevels",value:function(e){var t,n=e.getRootPointer(),a=e.getChildPointersFromBestToWorst(n)[0];ee(e.getNodeSummary(a).atomic.expect("Impossible: Child node has no atomic."))&&!this.state.gameState.pendingAnimalStep?this.updateUxState({analysisSuggestionDetailLevels:(t={},Object(d.a)(t,n,l.BestAction),Object(d.a)(t,a,l.BestAction),t)}):this.updateUxState({analysisSuggestionDetailLevels:Object(d.a)({},n,l.BestAction)})}},{key:"onPauseAnalyzerClicked",value:function(){this.mctsService.pause()}},{key:"onResumeAnalyzerClicked",value:function(){var e=this.state.mctsState;e.isRunning||(this.setState({mctsState:{isRunning:!0,mostRecentSnapshot:y.option.some(e.analyzer.getSnapshot())}}),this.mctsService.resume(e.analyzer))}},{key:"onDetailLevelChange",value:function(e,t){this.updateUxState({analysisSuggestionDetailLevels:Object(h.a)(Object(h.a)({},this.state.ux.analysisSuggestionDetailLevels),{},Object(d.a)({},e,t))})}},{key:"onTimeLimitEnabledChange",value:function(e){e.target.checked&&this.state.thinkingTimeInMS.isNone()&&this.saveAndUpdateThinkingTime(y.option.some(9e4)),!e.target.checked&&this.state.thinkingTimeInMS.isSome()&&this.saveAndUpdateThinkingTime(y.option.none())}},{key:"saveAndUpdateThinkingTime",value:function(e){this.setState({thinkingTimeInMS:e,thinkingTimeInputValue:e.match({none:function(){return""},some:function(e){return""+.001*e}})}),Fe(e)}},{key:"onThinkingTimeInputChange",value:function(e){var t=e.target.value,n=1e3*parseInt(t,10);n>0&&De(t)?this.saveAndUpdateThinkingTime(y.option.some(n)):this.setState({thinkingTimeInputValue:e.target.value})}},{key:"onMctsServiceOnStopTimeChange",value:function(e){this.setState({stopTime:e})}}]),n}(c.a.Component);function Ie(e){return e.allegiance===R.Alpha}function xe(e){return e.allegiance===R.Beta}function De(e){return/^\d+$/.test(e)&&!/^0\d/.test(e)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.analyzer=r,window.mcts=i,window.gameUtil=a,window.CardType=b,window.WorkerMessageType=P,m.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[19,1,2]]]);
//# sourceMappingURL=main.37b92127.chunk.js.map